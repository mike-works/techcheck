define(["fs","path","os","child_process"],function(r,e,t,n){"use strict";var o,i,s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var t in e)e.hasOwnProperty(t)&&(r[t]=e[t])};function a(r,e,t,n){return new(t||(t=Promise))(function(o,i){function s(r){try{u(n.next(r))}catch(r){i(r)}}function a(r){try{u(n.throw(r))}catch(r){i(r)}}function u(r){r.done?o(r.value):new t(function(e){e(r.value)}).then(s,a)}u((n=n.apply(r,e||[])).next())})}function u(r,e){var t,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,n&&(o=n[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(r,s)}catch(r){i=[6,r],n=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}(i=o||(o={}))[i.Ok=0]="Ok",i[i.Warning=1]="Warning",i[i.Error=2]="Error",i[i.Fail=3]="Fail";var c=function(){function r(r){this.config=r.config,this.registry=r.registry,this.env=r.env}return r.prototype.processVerifications=function(){return a(this,void 0,void 0,function(){var r,e,t=this;return u(this,function(n){switch(n.label){case 0:return r=this.config.options.verify,e=0,[4,Promise.all(r.map(function(r){return a(t,void 0,void 0,function(){var t,n;return u(this,function(o){switch(o.label){case 0:if(e++,t=r.name,null===(n=this.registry.getExtractor(t)))throw new Error('Found item in "root.verify['+e+']" pertaining to unknown extractor: '+t);return[4,n.getInfo(this.env,r)];case 1:return[2,o.sent()]}})})}))];case 1:return[2,n.sent().map(function(r){return{name:r.name,message:r.cmd+" "+r.normalized+" "+(r.match?"is OK    ":"is NOT OK"),found:r.normalized,target:r.target,status:r.match?o.Ok:o.Fail}})]}})})},r}(),f="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function l(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function p(r,e){return r(e={exports:{}},e.exports),e.exports}p(function(r,e){r.exports=function(){function r(r){return"function"==typeof r}var e=Array.isArray?Array.isArray:function(r){return"[object Array]"===Object.prototype.toString.call(r)},t=0,n=void 0,o=void 0,i=function(r,e){v[t]=r,v[t+1]=e,2===(t+=2)&&(o?o(m):b())},s="undefined"!=typeof window?window:void 0,a=s||{},u=a.MutationObserver||a.WebKitMutationObserver,c="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),p="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function h(){var r=setTimeout;return function(){return r(m,1)}}var v=new Array(1e3);function m(){for(var r=0;r<t;r+=2){var e=v[r],n=v[r+1];e(n),v[r]=void 0,v[r+1]=void 0}t=0}var d,g,y,w,b=void 0;function _(r,e){var t=this,n=new this.constructor(j);void 0===n[x]&&U(n);var o=t._state;if(o){var s=arguments[o-1];i(function(){return V(o,n,s,t._result)})}else I(t,n,r,e);return n}function E(r){if(r&&"object"==typeof r&&r.constructor===this)return r;var e=new this(j);return P(e,r),e}c?b=function(){return process.nextTick(m)}:u?(g=0,y=new u(m),w=document.createTextNode(""),y.observe(w,{characterData:!0}),b=function(){w.data=g=++g%2}):p?((d=new MessageChannel).port1.onmessage=m,b=function(){return d.port2.postMessage(0)}):b=void 0===s?function(){try{var r=l,e=r("vertx");return void 0!==(n=e.runOnLoop||e.runOnContext)?function(){n(m)}:h()}catch(r){return h()}}():h();var x=Math.random().toString(36).substring(16);function j(){}var O=void 0,k=1,S=2,R=new N;function A(r){try{return r.then}catch(r){return R.error=r,R}}function T(e,t,n){var o,s,a,u;t.constructor===e.constructor&&n===_&&t.constructor.resolve===E?(a=e,(u=t)._state===k?M(a,u._result):u._state===S?$(a,u._result):I(u,void 0,function(r){return P(a,r)},function(r){return $(a,r)})):n===R?($(e,R.error),R.error=null):void 0===n?M(e,t):r(n)?(o=t,s=n,i(function(r){var e=!1,t=function(r,e,t,n){try{r.call(e,t,n)}catch(r){return r}}(s,o,function(t){e||(e=!0,o!==t?P(r,t):M(r,t))},function(t){e||(e=!0,$(r,t))},r._label);!e&&t&&(e=!0,$(r,t))},e)):M(e,t)}function P(r,e){var t,n;r===e?$(r,new TypeError("You cannot resolve a promise with itself")):(n=typeof(t=e),null===t||"object"!==n&&"function"!==n?M(r,e):T(r,e,A(e)))}function C(r){r._onerror&&r._onerror(r._result),F(r)}function M(r,e){r._state===O&&(r._result=e,r._state=k,0!==r._subscribers.length&&i(F,r))}function $(r,e){r._state===O&&(r._state=S,r._result=e,i(C,r))}function I(r,e,t,n){var o=r._subscribers,s=o.length;r._onerror=null,o[s]=e,o[s+k]=t,o[s+S]=n,0===s&&r._state&&i(F,r)}function F(r){var e=r._subscribers,t=r._state;if(0!==e.length){for(var n=void 0,o=void 0,i=r._result,s=0;s<e.length;s+=3)n=e[s],o=e[s+t],n?V(t,n,o,i):o(i);r._subscribers.length=0}}function N(){this.error=null}var z=new N;function V(e,t,n,o){var i=r(n),s=void 0,a=void 0,u=void 0,c=void 0;if(i){if((s=function(r,e){try{return r(e)}catch(r){return z.error=r,z}}(n,o))===z?(c=!0,a=s.error,s.error=null):u=!0,t===s)return void $(t,new TypeError("A promises callback cannot return that same promise."))}else s=o,u=!0;t._state!==O||(i&&u?P(t,s):c?$(t,a):e===k?M(t,s):e===S&&$(t,s))}var W=0;function U(r){r[x]=W++,r._state=void 0,r._result=void 0,r._subscribers=[]}var q=function(){function r(r,t){this._instanceConstructor=r,this.promise=new r(j),this.promise[x]||U(this.promise),e(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?M(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&M(this.promise,this._result))):$(this.promise,new Error("Array Methods must be provided an Array"))}return r.prototype._enumerate=function(r){for(var e=0;this._state===O&&e<r.length;e++)this._eachEntry(r[e],e)},r.prototype._eachEntry=function(r,e){var t=this._instanceConstructor,n=t.resolve;if(n===E){var o=A(r);if(o===_&&r._state!==O)this._settledAt(r._state,e,r._result);else if("function"!=typeof o)this._remaining--,this._result[e]=r;else if(t===L){var i=new t(j);T(i,r,o),this._willSettleAt(i,e)}else this._willSettleAt(new t(function(e){return e(r)}),e)}else this._willSettleAt(n(r),e)},r.prototype._settledAt=function(r,e,t){var n=this.promise;n._state===O&&(this._remaining--,r===S?$(n,t):this._result[e]=t),0===this._remaining&&M(n,this._result)},r.prototype._willSettleAt=function(r,e){var t=this;I(r,void 0,function(r){return t._settledAt(k,e,r)},function(r){return t._settledAt(S,e,r)})},r}(),L=function(){function r(e){this[x]=W++,this._result=this._state=void 0,this._subscribers=[],j!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof r?function(r,e){try{e(function(e){P(r,e)},function(e){$(r,e)})}catch(e){$(r,e)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return r.prototype.catch=function(r){return this.then(null,r)},r.prototype.finally=function(r){var e=this.constructor;return this.then(function(t){return e.resolve(r()).then(function(){return t})},function(t){return e.resolve(r()).then(function(){throw t})})},r}();return L.prototype.then=_,L.all=function(r){return new q(this,r).promise},L.race=function(r){var t=this;return e(r)?new t(function(e,n){for(var o=r.length,i=0;i<o;i++)t.resolve(r[i]).then(e,n)}):new t(function(r,e){return e(new TypeError("You must pass an array to race."))})},L.resolve=E,L.reject=function(r){var e=new this(j);return $(e,r),e},L._setScheduler=function(r){o=r},L._setAsap=function(r){i=r},L._asap=i,L.polyfill=function(){var r=void 0;if(void 0!==f)r=f;else if("undefined"!=typeof self)r=self;else try{r=Function("return this")()}catch(r){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=r.Promise;if(e){var t=null;try{t=Object.prototype.toString.call(e.resolve())}catch(r){}if("[object Promise]"===t&&!e.cast)return}r.Promise=L},L.Promise=L,L}()}).polyfill();var h=/[|\\{}()[\]^$+*?.]/g,v=p(function(r){Object.defineProperty(r,"exports",{enumerable:!0,get:function(){var r={modifiers:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},colors:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],gray:[90,39]},bgColors:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49]}};return r.colors.grey=r.colors.gray,Object.keys(r).forEach(function(e){var t=r[e];Object.keys(t).forEach(function(e){var n=t[e];r[e]=t[e]={open:"["+n[0]+"m",close:"["+n[1]+"m"}}),Object.defineProperty(r,e,{value:t,enumerable:!1})}),r}})}),m=/[\u001b\u009b][[()#;?]*(?:[0-9]{1,4}(?:;[0-9]{0,4})*)?[0-9A-PRZcf-nqry=><]/g,d=new RegExp(/[\u001b\u009b][[()#;?]*(?:[0-9]{1,4}(?:;[0-9]{0,4})*)?[0-9A-PRZcf-nqry=><]/g.source),g=d.test.bind(d),y=process.argv,w=y.indexOf("--"),b=function(r){r="--"+r;var e=y.indexOf(r);return-1!==e&&(-1===w||e<w)},_="FORCE_COLOR"in process.env||!(b("no-color")||b("no-colors")||b("color=false"))&&(!!(b("color")||b("colors")||b("color=true")||b("color=always"))||!(process.stdout&&!process.stdout.isTTY)&&("win32"===process.platform||"COLORTERM"in process.env||"dumb"!==process.env.TERM&&!!/^screen|^xterm|^vt100|color|ansi|cygwin|linux/i.test(process.env.TERM))),E=Object.defineProperties,x="win32"===process.platform&&!/^xterm/i.test(process.env.TERM);function j(r){this.enabled=r&&void 0!==r.enabled?r.enabled:_}x&&(v.blue.open="[94m");var O,k,S=(O={},Object.keys(v).forEach(function(r){v[r].closeRe=new RegExp(function(r){if("string"!=typeof r)throw new TypeError("Expected a string");return r.replace(h,"\\$&")}(v[r].close),"g"),O[r]={get:function(){return A.call(this,this._styles.concat(r))}}}),O),R=E(function(){},S);function A(r){var e=function(){return function(){var r=arguments,e=r.length,t=0!==e&&String(arguments[0]);if(e>1)for(var n=1;n<e;n++)t+=" "+r[n];if(!this.enabled||!t)return t;var o=this._styles,i=o.length,s=v.dim.open;!x||-1===o.indexOf("gray")&&-1===o.indexOf("grey")||(v.dim.open="");for(;i--;){var a=v[o[i]];t=a.open+t.replace(a.closeRe,a.open)+a.close}return v.dim.open=s,t}.apply(e,arguments)};return e._styles=r,e.enabled=this.enabled,e.__proto__=R,e}E(j.prototype,(k={},Object.keys(S).forEach(function(r){k[r]={get:function(){return A.call(this,[r])}}}),k));var T=new j,P=v,C=g,M=function(r){return"string"==typeof r?r.replace(m,""):r},$=_;T.styles=P,T.hasColor=C,T.stripColor=M,T.supportsColor=$;var I=p(function(r,e){var t;e=r.exports=J,t="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){var r=Array.prototype.slice.call(arguments,0);r.unshift("SEMVER"),console.log.apply(console,r)}:function(){},e.SEMVER_SPEC_VERSION="2.0.0";var n=256,o=Number.MAX_SAFE_INTEGER||9007199254740991,i=e.re=[],s=e.src=[],a=0,u=a++;s[u]="0|[1-9]\\d*";var c=a++;s[c]="[0-9]+";var f=a++;s[f]="\\d*[a-zA-Z-][a-zA-Z0-9-]*";var l=a++;s[l]="("+s[u]+")\\.("+s[u]+")\\.("+s[u]+")";var p=a++;s[p]="("+s[c]+")\\.("+s[c]+")\\.("+s[c]+")";var h=a++;s[h]="(?:"+s[u]+"|"+s[f]+")";var v=a++;s[v]="(?:"+s[c]+"|"+s[f]+")";var m=a++;s[m]="(?:-("+s[h]+"(?:\\."+s[h]+")*))";var d=a++;s[d]="(?:-?("+s[v]+"(?:\\."+s[v]+")*))";var g=a++;s[g]="[0-9A-Za-z-]+";var y=a++;s[y]="(?:\\+("+s[g]+"(?:\\."+s[g]+")*))";var w=a++,b="v?"+s[l]+s[m]+"?"+s[y]+"?";s[w]="^"+b+"$";var _="[v=\\s]*"+s[p]+s[d]+"?"+s[y]+"?",E=a++;s[E]="^"+_+"$";var x=a++;s[x]="((?:<|>)?=?)";var j=a++;s[j]=s[c]+"|x|X|\\*";var O=a++;s[O]=s[u]+"|x|X|\\*";var k=a++;s[k]="[v=\\s]*("+s[O]+")(?:\\.("+s[O]+")(?:\\.("+s[O]+")(?:"+s[m]+")?"+s[y]+"?)?)?";var S=a++;s[S]="[v=\\s]*("+s[j]+")(?:\\.("+s[j]+")(?:\\.("+s[j]+")(?:"+s[d]+")?"+s[y]+"?)?)?";var R=a++;s[R]="^"+s[x]+"\\s*"+s[k]+"$";var A=a++;s[A]="^"+s[x]+"\\s*"+s[S]+"$";var T=a++;s[T]="(?:~>?)";var P=a++;s[P]="(\\s*)"+s[T]+"\\s+",i[P]=new RegExp(s[P],"g");var C=a++;s[C]="^"+s[T]+s[k]+"$";var M=a++;s[M]="^"+s[T]+s[S]+"$";var $=a++;s[$]="(?:\\^)";var I=a++;s[I]="(\\s*)"+s[$]+"\\s+",i[I]=new RegExp(s[I],"g");var F=a++;s[F]="^"+s[$]+s[k]+"$";var N=a++;s[N]="^"+s[$]+s[S]+"$";var z=a++;s[z]="^"+s[x]+"\\s*("+_+")$|^$";var V=a++;s[V]="^"+s[x]+"\\s*("+b+")$|^$";var W=a++;s[W]="(\\s*)"+s[x]+"\\s*("+_+"|"+s[k]+")",i[W]=new RegExp(s[W],"g");var U=a++;s[U]="^\\s*("+s[k]+")\\s+-\\s+("+s[k]+")\\s*$";var q=a++;s[q]="^\\s*("+s[S]+")\\s+-\\s+("+s[S]+")\\s*$";var L=a++;s[L]="(<|>)?=?\\s*\\*";for(var D=0;D<a;D++)t(D,s[D]),i[D]||(i[D]=new RegExp(s[D]));function G(r,e){if(r instanceof J)return r;if("string"!=typeof r)return null;if(r.length>n)return null;if(!(e?i[E]:i[w]).test(r))return null;try{return new J(r,e)}catch(r){return null}}function J(r,e){if(r instanceof J){if(r.loose===e)return r;r=r.version}else if("string"!=typeof r)throw new TypeError("Invalid Version: "+r);if(r.length>n)throw new TypeError("version is longer than "+n+" characters");if(!(this instanceof J))return new J(r,e);t("SemVer",r,e),this.loose=e;var s=r.trim().match(e?i[E]:i[w]);if(!s)throw new TypeError("Invalid Version: "+r);if(this.raw=r,this.major=+s[1],this.minor=+s[2],this.patch=+s[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");s[4]?this.prerelease=s[4].split(".").map(function(r){if(/^[0-9]+$/.test(r)){var e=+r;if(e>=0&&e<o)return e}return r}):this.prerelease=[],this.build=s[5]?s[5].split("."):[],this.format()}e.parse=G,e.valid=function(r,e){var t=G(r,e);return t?t.version:null},e.clean=function(r,e){var t=G(r.trim().replace(/^[=v]+/,""),e);return t?t.version:null},e.SemVer=J,J.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},J.prototype.toString=function(){return this.version},J.prototype.compare=function(r){return t("SemVer.compare",this.version,this.loose,r),r instanceof J||(r=new J(r,this.loose)),this.compareMain(r)||this.comparePre(r)},J.prototype.compareMain=function(r){return r instanceof J||(r=new J(r,this.loose)),Z(this.major,r.major)||Z(this.minor,r.minor)||Z(this.patch,r.patch)},J.prototype.comparePre=function(r){if(r instanceof J||(r=new J(r,this.loose)),this.prerelease.length&&!r.prerelease.length)return-1;if(!this.prerelease.length&&r.prerelease.length)return 1;if(!this.prerelease.length&&!r.prerelease.length)return 0;var e=0;do{var n=this.prerelease[e],o=r.prerelease[e];if(t("prerelease compare",e,n,o),void 0===n&&void 0===o)return 0;if(void 0===o)return 1;if(void 0===n)return-1;if(n!==o)return Z(n,o)}while(++e)},J.prototype.inc=function(r,e){switch(r){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",e),this.inc("pre",e);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var t=this.prerelease.length;--t>=0;)"number"==typeof this.prerelease[t]&&(this.prerelease[t]++,t=-2);-1===t&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error("invalid increment argument: "+r)}return this.format(),this.raw=this.version,this},e.inc=function(r,e,t,n){"string"==typeof t&&(n=t,t=void 0);try{return new J(r,t).inc(e,n).version}catch(r){return null}},e.diff=function(r,e){{if(Q(r,e))return null;var t=G(r),n=G(e);if(t.prerelease.length||n.prerelease.length){for(var o in t)if(("major"===o||"minor"===o||"patch"===o)&&t[o]!==n[o])return"pre"+o;return"prerelease"}for(var o in t)if(("major"===o||"minor"===o||"patch"===o)&&t[o]!==n[o])return o}},e.compareIdentifiers=Z;var Y=/^[0-9]+$/;function Z(r,e){var t=Y.test(r),n=Y.test(e);return t&&n&&(r=+r,e=+e),t&&!n?-1:n&&!t?1:r<e?-1:r>e?1:0}function B(r,e,t){return new J(r,t).compare(new J(e,t))}function X(r,e,t){return B(r,e,t)>0}function K(r,e,t){return B(r,e,t)<0}function Q(r,e,t){return 0===B(r,e,t)}function H(r,e,t){return 0!==B(r,e,t)}function rr(r,e,t){return B(r,e,t)>=0}function er(r,e,t){return B(r,e,t)<=0}function tr(r,e,t,n){var o;switch(e){case"===":"object"==typeof r&&(r=r.version),"object"==typeof t&&(t=t.version),o=r===t;break;case"!==":"object"==typeof r&&(r=r.version),"object"==typeof t&&(t=t.version),o=r!==t;break;case"":case"=":case"==":o=Q(r,t,n);break;case"!=":o=H(r,t,n);break;case">":o=X(r,t,n);break;case">=":o=rr(r,t,n);break;case"<":o=K(r,t,n);break;case"<=":o=er(r,t,n);break;default:throw new TypeError("Invalid operator: "+e)}return o}function nr(r,e){if(r instanceof nr){if(r.loose===e)return r;r=r.value}if(!(this instanceof nr))return new nr(r,e);t("comparator",r,e),this.loose=e,this.parse(r),this.semver===or?this.value="":this.value=this.operator+this.semver.version,t("comp",this)}e.rcompareIdentifiers=function(r,e){return Z(e,r)},e.major=function(r,e){return new J(r,e).major},e.minor=function(r,e){return new J(r,e).minor},e.patch=function(r,e){return new J(r,e).patch},e.compare=B,e.compareLoose=function(r,e){return B(r,e,!0)},e.rcompare=function(r,e,t){return B(e,r,t)},e.sort=function(r,t){return r.sort(function(r,n){return e.compare(r,n,t)})},e.rsort=function(r,t){return r.sort(function(r,n){return e.rcompare(r,n,t)})},e.gt=X,e.lt=K,e.eq=Q,e.neq=H,e.gte=rr,e.lte=er,e.cmp=tr,e.Comparator=nr;var or={};function ir(r,e){if(r instanceof ir)return r.loose===e?r:new ir(r.raw,e);if(r instanceof nr)return new ir(r.value,e);if(!(this instanceof ir))return new ir(r,e);if(this.loose=e,this.raw=r,this.set=r.split(/\s*\|\|\s*/).map(function(r){return this.parseRange(r.trim())},this).filter(function(r){return r.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+r);this.format()}function sr(r){return!r||"x"===r.toLowerCase()||"*"===r}function ar(r,e,t,n,o,i,s,a,u,c,f,l,p){return((e=sr(t)?"":sr(n)?">="+t+".0.0":sr(o)?">="+t+"."+n+".0":">="+e)+" "+(a=sr(u)?"":sr(c)?"<"+(+u+1)+".0.0":sr(f)?"<"+u+"."+(+c+1)+".0":l?"<="+u+"."+c+"."+f+"-"+l:"<="+a)).trim()}function ur(r,e){for(var n=0;n<r.length;n++)if(!r[n].test(e))return!1;if(e.prerelease.length){for(n=0;n<r.length;n++)if(t(r[n].semver),r[n].semver!==or&&r[n].semver.prerelease.length>0){var o=r[n].semver;if(o.major===e.major&&o.minor===e.minor&&o.patch===e.patch)return!0}return!1}return!0}function cr(r,e,t){try{e=new ir(e,t)}catch(r){return!1}return e.test(r)}function fr(r,e,t,n){var o,i,s,a,u;switch(r=new J(r,n),e=new ir(e,n),t){case">":o=X,i=er,s=K,a=">",u=">=";break;case"<":o=K,i=rr,s=X,a="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(cr(r,e,n))return!1;for(var c=0;c<e.set.length;++c){var f=null,l=null;if(e.set[c].forEach(function(r){r.semver===or&&(r=new nr(">=0.0.0")),f=f||r,l=l||r,o(r.semver,f.semver,n)?f=r:s(r.semver,l.semver,n)&&(l=r)}),f.operator===a||f.operator===u)return!1;if((!l.operator||l.operator===a)&&i(r,l.semver))return!1;if(l.operator===u&&s(r,l.semver))return!1}return!0}nr.prototype.parse=function(r){var e=this.loose?i[z]:i[V],t=r.match(e);if(!t)throw new TypeError("Invalid comparator: "+r);this.operator=t[1],"="===this.operator&&(this.operator=""),t[2]?this.semver=new J(t[2],this.loose):this.semver=or},nr.prototype.toString=function(){return this.value},nr.prototype.test=function(r){return t("Comparator.test",r,this.loose),this.semver===or||("string"==typeof r&&(r=new J(r,this.loose)),tr(r,this.operator,this.semver,this.loose))},nr.prototype.intersects=function(r,e){if(!(r instanceof nr))throw new TypeError("a Comparator is required");var t;if(""===this.operator)return t=new ir(r.value,e),cr(this.value,t,e);if(""===r.operator)return t=new ir(this.value,e),cr(r.semver,t,e);var n=!(">="!==this.operator&&">"!==this.operator||">="!==r.operator&&">"!==r.operator),o=!("<="!==this.operator&&"<"!==this.operator||"<="!==r.operator&&"<"!==r.operator),i=this.semver.version===r.semver.version,s=!(">="!==this.operator&&"<="!==this.operator||">="!==r.operator&&"<="!==r.operator),a=tr(this.semver,"<",r.semver,e)&&(">="===this.operator||">"===this.operator)&&("<="===r.operator||"<"===r.operator),u=tr(this.semver,">",r.semver,e)&&("<="===this.operator||"<"===this.operator)&&(">="===r.operator||">"===r.operator);return n||o||i&&s||a||u},e.Range=ir,ir.prototype.format=function(){return this.range=this.set.map(function(r){return r.join(" ").trim()}).join("||").trim(),this.range},ir.prototype.toString=function(){return this.range},ir.prototype.parseRange=function(r){var e=this.loose;r=r.trim(),t("range",r,e);var n=e?i[q]:i[U];r=r.replace(n,ar),t("hyphen replace",r),r=r.replace(i[W],"$1$2$3"),t("comparator trim",r,i[W]),r=(r=(r=r.replace(i[P],"$1~")).replace(i[I],"$1^")).split(/\s+/).join(" ");var o=e?i[z]:i[V],s=r.split(" ").map(function(r){return o=e,t("comp",n=r),f=o,n=n.trim().split(/\s+/).map(function(r){return function(r,e){t("caret",r,e);var n=e?i[N]:i[F];return r.replace(n,function(e,n,o,i,s){var a;return t("caret",r,e,n,o,i,s),sr(n)?a="":sr(o)?a=">="+n+".0.0 <"+(+n+1)+".0.0":sr(i)?a="0"===n?">="+n+"."+o+".0 <"+n+"."+(+o+1)+".0":">="+n+"."+o+".0 <"+(+n+1)+".0.0":s?(t("replaceCaret pr",s),"-"!==s.charAt(0)&&(s="-"+s),a="0"===n?"0"===o?">="+n+"."+o+"."+i+s+" <"+n+"."+o+"."+(+i+1):">="+n+"."+o+"."+i+s+" <"+n+"."+(+o+1)+".0":">="+n+"."+o+"."+i+s+" <"+(+n+1)+".0.0"):(t("no pr"),a="0"===n?"0"===o?">="+n+"."+o+"."+i+" <"+n+"."+o+"."+(+i+1):">="+n+"."+o+"."+i+" <"+n+"."+(+o+1)+".0":">="+n+"."+o+"."+i+" <"+(+n+1)+".0.0"),t("caret return",a),a})}(r,f)}).join(" "),t("caret",n),c=o,n=n.trim().split(/\s+/).map(function(r){return e=r,n=c?i[M]:i[C],e.replace(n,function(r,n,o,i,s){var a;return t("tilde",e,r,n,o,i,s),sr(n)?a="":sr(o)?a=">="+n+".0.0 <"+(+n+1)+".0.0":sr(i)?a=">="+n+"."+o+".0 <"+n+"."+(+o+1)+".0":s?(t("replaceTilde pr",s),"-"!==s.charAt(0)&&(s="-"+s),a=">="+n+"."+o+"."+i+s+" <"+n+"."+(+o+1)+".0"):a=">="+n+"."+o+"."+i+" <"+n+"."+(+o+1)+".0",t("tilde return",a),a});var e,n}).join(" "),t("tildes",n),t("replaceXRanges",a=n,u=o),n=a.split(/\s+/).map(function(r){return function(r,e){r=r.trim();var n=e?i[A]:i[R];return r.replace(n,function(e,n,o,i,s,a){t("xRange",r,e,n,o,i,s,a);var u=sr(o),c=u||sr(i),f=c||sr(s),l=f;return"="===n&&l&&(n=""),u?e=">"===n||"<"===n?"<0.0.0":"*":n&&l?(c&&(i=0),f&&(s=0),">"===n?(n=">=",c?(o=+o+1,i=0,s=0):f&&(i=+i+1,s=0)):"<="===n&&(n="<",c?o=+o+1:i=+i+1),e=n+o+"."+i+"."+s):c?e=">="+o+".0.0 <"+(+o+1)+".0.0":f&&(e=">="+o+"."+i+".0 <"+o+"."+(+i+1)+".0"),t("xRange return",e),e})}(r,u)}).join(" "),t("xrange",n),t("replaceStars",s=n,o),n=s.trim().replace(i[L],""),t("stars",n),n;var n,o,s,a,u,c,f}).join(" ").split(/\s+/);return this.loose&&(s=s.filter(function(r){return!!r.match(o)})),s=s.map(function(r){return new nr(r,e)})},ir.prototype.intersects=function(r,e){if(!(r instanceof ir))throw new TypeError("a Range is required");return this.set.some(function(t){return t.every(function(t){return r.set.some(function(r){return r.every(function(r){return t.intersects(r,e)})})})})},e.toComparators=function(r,e){return new ir(r,e).set.map(function(r){return r.map(function(r){return r.value}).join(" ").trim().split(" ")})},ir.prototype.test=function(r){if(!r)return!1;"string"==typeof r&&(r=new J(r,this.loose));for(var e=0;e<this.set.length;e++)if(ur(this.set[e],r))return!0;return!1},e.satisfies=cr,e.maxSatisfying=function(r,e,t){var n=null,o=null;try{var i=new ir(e,t)}catch(r){return null}return r.forEach(function(r){i.test(r)&&(n&&-1!==o.compare(r)||(o=new J(n=r,t)))}),n},e.minSatisfying=function(r,e,t){var n=null,o=null;try{var i=new ir(e,t)}catch(r){return null}return r.forEach(function(r){i.test(r)&&(n&&1!==o.compare(r)||(o=new J(n=r,t)))}),n},e.validRange=function(r,e){try{return new ir(r,e).range||"*"}catch(r){return null}},e.ltr=function(r,e,t){return fr(r,e,"<",t)},e.gtr=function(r,e,t){return fr(r,e,">",t)},e.outside=fr,e.prerelease=function(r,e){var t=G(r,e);return t&&t.prerelease.length?t.prerelease:null},e.intersects=function(r,e,t){return r=new ir(r,t),e=new ir(e,t),r.intersects(e)}}),F=I.gte,N=I.lte,z=I.satisfies,V=I.validRange;function W(r,e){if("string"!=typeof r.name)return[{path:"root.verify["+e+"].name",message:"should be a string"}];if(r.version instanceof RegExp)return[];if(r.version instanceof Function)return[];if("string"==typeof r.version)return[];if(r.version instanceof Array)return[{path:"root.verify["+e+"].version",message:"should be an array"}];if(r.version instanceof Object){var t=r.version;return"string"==typeof t.semver?V(t.semver)?[]:[{path:"root.verify["+e+"].version.semver",message:"invalid semver string: "+t.semver}]:r.version.semver&&(r.version.semver.min||r.version.semver.max||r.version.semver.range)?[]:[{path:"root.verify["+e+"].version",message:"invalid object "+JSON.stringify(r.version)}]}return[]}function U(r){if(!(r.verify instanceof Object))return[{path:"root",message:"should be an object"}];var e=function(r){if(!(r instanceof Array))return[{path:"root.verify",message:"should be an array"}];for(var e=0;e<r.length;e++){var t=W(r[e],e);if(t.length>0)return t}return[]}(r.verify);return e.length>0?e:[]}function q(t){return void 0===t&&(t=process.cwd()),a(this,void 0,void 0,function(){var n;return u(this,function(o){switch(o.label){case 0:return[4,function(e){return a(this,void 0,void 0,function(){return u(this,function(t){return[2,new Promise(function(t,n){r.exists(e,function(r){t(r?require(e):void 0)})})]})})}(e.join(t,"techcheck.config.js"))];case 1:return(n=o.sent())?[2,n]:[2,q(e.join(t,".."))]}})})}var L,D,G=function(){function r(){}return Object.defineProperty(r.prototype,"options",{get:function(){if(!this.optionsModule)throw new Error("Attempted to access project config options before it was populated");return this.optionsModule},enumerable:!0,configurable:!0}),r.prototype.setup=function(){return a(this,void 0,void 0,function(){var r,e;return u(this,function(t){switch(t.label){case 0:return[4,q()];case 1:if(r=t.sent(),e=U(r),this.optionsModule=r,e.length>0)throw new Error(e.map(function(r){return T.bgRed.white("Config file format error at "+r.path+", "+r.message)}).join("\n"));return[2]}})})},r}();function J(r,e,t){return r+"\n"+e+t.replace(/\n/g,"\n"+e)}(D=L||(L={}))[D.Win32=0]="Win32",D[D.Posix=1]="Posix",D[D.Unsupported=2]="Unsupported";var Y=["aix","darwin","freebsd","linux","openbsd","cygwin"];var Z=L;function B(r,e){var t=r;return e instanceof RegExp?e.test(t):"string"==typeof e?e===t:e instanceof Function?e(t):function(r,e){var t,n,o="string"!=typeof e?e.range:e;if("string"!=typeof e&&(t=e.min,n=e.max),void 0!==o)return z(r,o);if(void 0!==n)return void 0!==t?F(r,t)&&N(r,n):N(r,n);if(void 0!==t)return F(r,t);throw new Error("Invalid SemVerMatcher object "+JSON.stringify(e))}(t,e.semver)}function X(r,e){if(void 0===e||!((t=e)instanceof RegExp||t instanceof Function||"string"==typeof t||void 0!==t.semver&&("string"==typeof t.semver&&void 0!==V(t.semver)||"string"!=typeof t.semver&&(void 0!==t.semver.max||void 0!==t.semver.min||void 0!==t.semver.range))))throw new Error("Invalid matcher: "+JSON.stringify(e));var t;return B(r,e)}var K=function(){function r(r){var e=r.name,t=r.platforms,n=r.normalizerOptions;this.platforms=t,this.name=e,this.normalizerOptions=n}return r.prototype.handlesPlatform=function(r){return this.platforms.indexOf(r)>=0},r.prototype.getInfo=function(e,t){return a(this,void 0,void 0,function(){var n,o,i,s,a;return u(this,function(u){switch(u.label){case 0:if(!this.handlesPlatform(e.platform))throw new Error("Extractor "+this.name+" does not support "+L[e.platform]);if(!(n=Object.keys(t).reduce(function(r,e){return"name"===e?r:(r.push(e),r)},[])[0]))throw new Error("Extractor "+this.name+" didn't know which command to execute");return[4,this.getInfoForEnvironment(e,n,t)];case 1:return o=u.sent(),i=r.unbrand(o),s=function(r,e){if(void 0===e)return r;if(e instanceof RegExp){var t=e.exec(r);return t&&t.length>0?t[0]:""}return e(r)}(i,this.normalizerOptions?this.normalizerOptions.preprocessor:void 0),a=n?t[n]:t,[2,{raw:i,cmd:n,normalized:s,name:this.name,target:a,match:X(s,a)}]}})})},r.unbrand=function(r){return r.val},r.brand=function(e){return{val:e,_brand:r.brandStamp}},r}();var Q,H,rr=function(r){function e(e){var t=r.call(this,e)||this;return t.commands=JSON.parse(JSON.stringify(e.commands)),t}return function(r,e){function t(){this.constructor=r}s(r,e),r.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}(e,r),e.prototype.getInfoForEnvironment=function(r,e,t){return a(this,void 0,void 0,function(){var r;return u(this,function(t){switch(t.label){case 0:return r={},[4,(o=this.commands[e],new Promise(function(r,e){n.exec(o,function(t,n,o){null!==t?e(new Error(o)):r(n)})}))];case 1:return[2,(r.val=t.sent().trim(),r._brand=K.brandStamp,r)]}var o})})},e}(K),er=new rr({name:"OpenSSL",platforms:[L.Win32,L.Posix],commands:{version:"openssl version"},normalizerOptions:{preprocessor:/[0-9\.]+/}}),tr=new rr({name:"Node.js",platforms:[L.Win32,L.Posix],commands:{version:"node --version"},normalizerOptions:{preprocessor:/[0-9\.]+/}}),nr=new rr({name:"PosgreSQL",platforms:[L.Win32,L.Posix],commands:{version:"pg_ctl --version"},normalizerOptions:{preprocessor:/[0-9\.]+/}}),or=function(){function r(){this.extractors={}}return r.prototype.setup=function(){return a(this,void 0,void 0,function(){var r;return u(this,function(e){try{this.setupStandardExtractors()}catch(e){throw(r=e).message=J("Unable to setup extractor registry","  ",r.message),r}return[2]})})},r.prototype.setupStandardExtractors=function(){this.extractors.openssl=er,this.extractors.node=tr,this.extractors.postgres=nr},r.prototype.getExtractor=function(r){return this.extractors[r]||null},r}(),ir={platform:(H=t.platform(),"win32"===(Q=H)?L.Win32:Y.indexOf(Q)>=0?L.Posix:L.Unsupported)},sr=function(){return function(r){if(void 0===r&&(r={}),this.options={platform:void 0===r.platform?ir.platform:r.platform},this.options.platform===Z.Unsupported)throw new Error("Unsupported platform: "+Z[this.options.platform]);this.platform=this.options.platform}}();function ar(r,e){r.write("\n"+T.yellow("ðŸ” TechCheck Scan: Making sure you're all set up ðŸ”Ž")+"\n"),r.write(" ------------------------------------------------\n"),e.forEach(function(e){var t,n,i,s,a,u,c,f;e.status===o.Ok&&(t=r,i="  âœ…  "+(n=e).name+"\t"+n.message,i+=T.grey("\t(required: "+ur(n.target)+" )"),t.write(i+"\n")),e.status===o.Error&&(s=e,r.write("  ðŸ’¥  "+s.name+"\n")),e.status===o.Warning&&(a=e,r.write("  âš ï¸  "+a.name+"\n")),e.status===o.Fail&&(u=r,f="  ðŸ›‘  "+(c=e).name+"\t"+c.message,f+=T.grey("\t(required: "+ur(c.target)+" )"),u.write(f+"\n"))})}function ur(r){if("string"==typeof r)return"= "+T.yellow('"'+r+'"');if(r instanceof RegExp)return"~ "+T.magenta("/"+r.source+"/");if(r instanceof Function)return T.cyan(""+r.toString());if(r.semver){var e=r.semver;if("string"==typeof e)return T.green(""+e);if(e.range)return T.green(""+e.range);if(e.min&&e.max)return T.green(">= "+e.min+" && <= "+e.max);if(e.min)return T.green(">= "+e.min);if(e.max)return T.green("<= "+e.max)}}function cr(){return a(this,void 0,void 0,function(){var r,e,t,n;return u(this,function(i){switch(i.label){case 0:return r=new sr,[4,function(){return a(this,void 0,void 0,function(){var r,e,t;return u(this,function(n){switch(n.label){case 0:r=new or,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,r.setup()];case 2:return n.sent(),[2,{registry:r}];case 3:throw e=n.sent(),(t=e).message=J("Unable to setup extractor registry","  ",t.message),t;case 4:return[2]}})})}()];case 1:return e=i.sent().registry,[4,function(){return a(this,void 0,void 0,function(){var r,e;return u(this,function(t){switch(t.label){case 0:r=new G,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.setup()];case 2:return t.sent(),[3,4];case 3:throw(e=t.sent())instanceof Error?(e.message=J("Unable to setup project config","  ",e.message),e):e;case 4:return[2,{config:r}]}})})}()];case 2:return t=i.sent().config,[4,new c({env:r,registry:e,config:t}).processVerifications()];case 3:return n=i.sent(),ar(process.stdout,n),[2,n.reduce(function(r,e){return r?[o.Ok,o.Warning].indexOf(e.status)>=0:r},!0)]}})})}(function(){return a(this,void 0,void 0,function(){var r;return u(this,function(e){switch(e.label){case 0:return[4,cr()];case 1:return r=e.sent(),process.exit(r?0:1),[2]}})})})().catch(function(r){if(r instanceof Error){var e=""+r;r instanceof Error&&r.stack&&(e=r.stack),e=e.split("\n").map(function(r){return T.red(r)}).join("\n"),console.error(T.red(e))}})});
//# sourceMappingURL=index.js.map
